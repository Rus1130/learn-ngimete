<style>
    textarea {
        resize: none;
    }

    textarea:focus {
        outline: none;
    }

    #out {
        margin-bottom: 4px;
    }

    #out {
        font-family: monospace;
        width: 100%;
        overflow: hidden;
        resize: none;
        border: 1px solid #ccc;
        padding: 5px;
        white-space: pre-wrap;   /* preserve spaces and line breaks */
        word-wrap: break-word;   /* legacy, widely supported */
        overflow-wrap: anywhere; /* modern way to break anywhere */
    }
</style>

<head>
    <meta charset="UTF-8">
</head>

<body>
    Type a dash (-) to automatically put it the correct connecting letter.<br><br>
    <textarea id="input" style="width: 100%; height: 80px; font-family: monospace;" placeholder="write text here" spellcheck="false"></textarea>

    <textarea id="out" style="font-family: monospace; margin-top: 10px;" readonly placeholder="output" spellcheck="false"></textarea>

    <button id="both" style="padding: 10px;">copy both</button>
    <button id="ortho" style="padding: 10px;">copy ortho</button>
    <button id="ipa" style="padding: 10px;">copy IPA</button>
    <!-- <label for="lineup">
        <input type="checkbox" id="lineup" checked>
        Line Up
    </label> -->
</body>
<script type="module">
import { Writer } from './lib.js';

const input = document.getElementById("input");
const output = document.getElementById("out");

const bothButton = document.getElementById("both");
const orthoButton = document.getElementById("ortho");
const ipaButton = document.getElementById("ipa");
// const lineUpCheckbox = document.getElementById("lineup");

function setOutputText(text) {
    output.value = text;

    // Reset height to auto to recalc
    output.style.height = "auto";

    // Set height to scrollHeight to fit content
    output.style.height = output.scrollHeight + "px";
}

function updateOutput() {
    const value = input.value;
    if (!value) {
        setOutputText("");
        return;
    }

    const w = new Writer(value);
    let text = w.both();
    
    setOutputText(text);
}


input.addEventListener("input", updateOutput);
// lineUpCheckbox.addEventListener("change", updateOutput);

bothButton.addEventListener("click", () => {
    const value = input.value;
    if (!value) return;

    navigator.clipboard.writeText(new Writer(value).both());
    bothButton.innerText = "copied!";
    setTimeout(() => bothButton.innerText = "copy both", 2000);
});

orthoButton.addEventListener("click", () => {
    const value = input.value;
    if (!value) return;

    navigator.clipboard.writeText(new Writer(value).ortho());
    orthoButton.innerText = "copied!";
    setTimeout(() => orthoButton.innerText = "copy ortho", 2000);
});

ipaButton.addEventListener("click", () => {
    const value = input.value;
    if (!value) return;

    navigator.clipboard.writeText(new Writer(value).ipa());
    ipaButton.innerText = "copied!";
    setTimeout(() => ipaButton.innerText = "copy IPA", 2000);
});
</script>
